# Doctest overview

This doc is used to validate the doctest runner. Every fenced block is a test by default.

## Basic shell check

```sh
test -d 'doctest'
```

## Workdir override

```sh workdir=doctest/docs
test -f 'overview.mdx'
```

## Runner environment

```sh
test -n "$DOCTEST_ROOT"
test -d "$DOCTEST_ROOT/doctest"
test -n "$DOCTEST_FILE"
```

## Per-block temp dir

```sh
test -n "$DOCTEST_TMP"
touch "$DOCTEST_TMP/marker"
test -f "$DOCTEST_TMP/marker"
```

## Environment injection

```sh env=FOO=bar
test "$FOO" = 'bar'
```

## JavaScript block

```js
if (!process.env.DOCTEST_ROOT || !process.env.DOCTEST_FILE) {
  process.exit(1)
}
```

## TypeScript block

```ts
const root = process.env.DOCTEST_ROOT
const workdir = process.env.DOCTEST_WORKDIR
if (!root || !workdir) {
  process.exit(1)
}
```

## Lua block (headless Neovim)

```lua
local root = os.getenv('DOCTEST_ROOT')
assert(root and root ~= '')
assert(vim.g.headless_mode == true)
assert(vim.o.runtimepath:find(root, 1, true))
```

## Opt out

```sh no-doctest
exit 1
```
